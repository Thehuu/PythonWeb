/*
 Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
*/
(function(){CKEDITOR.plugins.add("autolink",{requires:"clipboard,textmatch,link",isSupportedEnvironment:function(){return!CKEDITOR.env.ie||CKEDITOR.env.edge},init:function(c){function e(a){a=CKEDITOR.tools.htmlDecodeAttr(a);var b=new CKEDITOR.dom.element("a"),d=a.replace(/"/g,"%22"),d=d.match(c.config.autolink_urlRegex)?d:"mailto:"+d;b.setText(a);b.setAttribute("href",d);a=CKEDITOR.plugins.link.parseLinkAttributes(c,b);a=CKEDITOR.plugins.link.getLinkAttributes(c,a);CKEDITOR.tools.isEmpty(a.set)||
b.setAttributes(a.set);a.removed.length&&b.removeAttributes(a.removed);b.removeAttribute("data-cke-saved-href");return b.getOuterHtml()}function f(a,b){var d=a.slice(0,b).split(/\s+/),d=d[d.length-1];return!d||!d.match(c.config.autolink_urlRegex)&&!d.match(c.config.autolink_emailRegex)?null:{start:a.lastIndexOf(d),end:b}}this.isSupportedEnvironment()&&(c.on("paste",function(a){if(a.data.dataTransfer.getTransferType(c)!=CKEDITOR.DATA_TRANSFER_INTERNAL){var b=a.data.dataValue;if(!(-1<b.indexOf("\x3c"))&&
(b.match(c.config.autolink_urlRegex)||b.match(c.config.autolink_emailRegex)))a.data.dataValue=e(b),a.data.type="html"}}),c.on("key",function(a){if(!("wysiwyg"!==c.mode||-1==CKEDITOR.tools.indexOf(c.config.autolink_commitKeystrokes,a.data.keyCode))){var b=CKEDITOR.plugins.textMatch.match(c.getSelection().getRanges()[0],f);if(b&&(a=c.getSelection(),!a.getRanges()[0].startContainer.getAscendant("a",!0)&&(a.selectRanges([b.range]),c.insertHtml(e(b.text),"text"),!CKEDITOR.env.webkit))){var b=a.getRanges()[0],
d=c.createRange();d.setStartAfter(b.startContainer);a.selectRanges([d])}}}))}});CKEDITOR.config.autolink_commitKeystrokes=[13,32];CKEDITOR.config.autolink_urlRegex=/^(https?|ftp):\/\/(-\.)?([^\s\/?\.#]\.?)+(\/[^\s]*)?[^\s\.,]$/i;CKEDITOR.config.autolink_emailRegex=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/})();