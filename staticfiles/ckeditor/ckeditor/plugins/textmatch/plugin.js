/*
 Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
*/
(function(){function h(c,d){for(var a=c.length,b=0,e=0;e<a;e+=1){var g=c[e];if(d>=b&&b+g.getText().length>=d)return{element:g,offset:d-b};b+=g.getText().length}return null}function m(c,d){for(var a=0;a<c.length;a++)if(d(c[a]))return a;return-1}CKEDITOR.plugins.add("textmatch",{});CKEDITOR.plugins.textMatch={};CKEDITOR.plugins.textMatch.match=function(c,d){var a=CKEDITOR.plugins.textMatch.getTextAndOffset(c),b=CKEDITOR.dom.selection.FILLING_CHAR_SEQUENCE,e=0;if(a)return 0==a.text.indexOf(b)&&(e=b.length,
a.text=a.text.replace(b,""),a.offset-=e),b=d(a.text,a.offset),!b?null:{range:CKEDITOR.plugins.textMatch.getRangeInText(c,b.start,b.end+e),text:a.text.slice(b.start,b.end)}};CKEDITOR.plugins.textMatch.getTextAndOffset=function(c){if(!c.collapsed)return null;var d="",a=0,b=CKEDITOR.plugins.textMatch.getAdjacentTextNodes(c),e=!1,g,h=c.startContainer.type!=CKEDITOR.NODE_ELEMENT;g=h?m(b,function(a){return c.startContainer.equals(a)}):c.startOffset-(b[0]?b[0].getIndex():0);for(var k=b.length,f=0;f<k;f+=
1){var l=b[f],d=d+l.getText();e||(h?f==g?(e=!0,a+=c.startOffset):a+=l.getText().length:(f==g&&(e=!0),0<f&&(a+=b[f-1].getText().length),k==g&&f+1==k&&(a+=l.getText().length)))}return{text:d,offset:a}};CKEDITOR.plugins.textMatch.getRangeInText=function(c,d,a){var b=new CKEDITOR.dom.range(c.root);c=CKEDITOR.plugins.textMatch.getAdjacentTextNodes(c);d=h(c,d);a=h(c,a);b.setStart(d.element,d.offset);b.setEnd(a.element,a.offset);return b};CKEDITOR.plugins.textMatch.getAdjacentTextNodes=function(c){if(!c.collapsed)return[];
var d=[],a,b,e;c.startContainer.type!=CKEDITOR.NODE_ELEMENT?(a=c.startContainer.getParent().getChildren(),c=c.startContainer.getIndex()):(a=c.startContainer.getChildren(),c=c.startOffset);for(e=c;b=a.getItem(--e);)if(b.type==CKEDITOR.NODE_TEXT)d.unshift(b);else break;for(e=c;b=a.getItem(e++);)if(b.type==CKEDITOR.NODE_TEXT)d.push(b);else break;return d}})();